org: akaish
app: kurral-api-app

service: kurral-api


provider:
  name: aws
  runtime: nodejs12.x
  region: ${opt:region,"us-east-2"}
  stage: 'prod'
  environment:
    THIRUKKURAL_TABLE_NAME: ${self:custom.dynamodb.THIRUKKURAL_TABLE_NAME}
    ADIKARAM_TABLE_NAME: ${self:custom.dynamodb.ADIKARAM_TABLE_NAME}
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:*
      Resource: '*'
    - Effect: Allow
      Action:
        - ec2:DetachNetworkInterface
        - ec2:DescribeNetworkInterfaces
        - ec2:DeleteNetworkInterface
      Resource: '*'

package:
  include:
    - src/**/*
    - node_modules/**/*

functions:
  createKurral:
    handler: src/handler.create
    events:
      - http:
          path: /thirukurral/create
          method: POST
          cors: true
          private: true
  readKurral:
    handler: src/handler.getKurral
    events:
      - http:
          path: /thirukurral/getKurral
          method: GET
          cors: true
          private: true
  getAdikaram:
    handler: src/handler.getAllAdikaram
    events:
      - http:
          path: /thirukurral/adikaram
          method: GET
          cors: true
          private: true

custom:
  dynamodb:
    THIRUKKURAL_TABLE_NAME: thirukurral_data
    ADIKARAM_TABLE_NAME: adikaram_master
  serverless-offline:
    httpPort: 4000

# plugins:
#   - serverless-offline
